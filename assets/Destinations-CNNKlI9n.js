import{d as R,u as N,r as k,o as P,c as y,a as r,b as t,F as f,e as g,f as V,g as l,t as o,w,v as S,n as z,h as u,P as d,i as $,j as p,k as x,l as C,m as D,_ as j}from"./index-CLbUFQeI.js";const F={class:"mb-5 md:d-flex mx-auto",style:{"max-width":"50rem"}},T={style:{"min-width":"49%"}},U={id:"main-destination-list",class:"mt-2"},Y=["onClick"],L={class:"ml-auto p-2"},M={class:"d-inline"},A={class:"d-flex"},G={class:"w-100"},H={class:"d-flex",style:{position:"relative"}},J={class:"circle-count"},K={style:{position:"relative"}},Q={style:{position:"relative"}},W={class:"bold",style:{"padding-left":"0.25rem",transform:"translateY(50%)"}},X={class:"d-flex gap-1 my-1",style:{"padding-left":"0.5rem","flex-wrap":"wrap"}},Z={class:"circle-count-sm-tan"},tt={class:"bold"},st={class:"text-right"},et={class:"d-flex"},nt={class:"text-sm"},it={class:"ml-auto",style:{width:"auto","text-wrap":"nowrap"}},ot={style:{"min-width":"49%"}},lt={id:"main-destination-list",class:"mt-2"},dt=["onClick"],at={class:"ml-auto p-2"},ct={class:"d-inline"},rt={class:"d-flex"},ut={class:"w-100"},_t={class:"d-flex",style:{position:"relative"}},mt={class:"circle-count"},vt={style:{position:"relative"}},ht={style:{position:"relative"}},ft={class:"bold",style:{"padding-left":"0.25rem",transform:"translateY(50%)"}},gt={class:"d-flex gap-1 my-1",style:{"padding-left":"0.5rem","flex-wrap":"wrap"}},pt={class:"circle-count-sm-tan"},xt={class:"bold"},Ct={class:"text-right"},Dt={class:"d-flex"},bt={class:"text-sm"},It={class:"ml-auto",style:{width:"auto","text-wrap":"nowrap"}},kt=R({__name:"Destinations",setup(yt){const{contracts:b}=N(),v=k([]),h=k([]);P(()=>{b.forEach(m=>{m.payloads.forEach(s=>{v.value.some(i=>i.locationId===s.originID)||v.value.push({locationId:s.originID,open:!0}),h.value.some(i=>i.locationId===s.destinationID)||h.value.push({locationId:s.destinationID,open:!0})})}),console.log("Contract Origins:",v.value),console.log("Contract Destinations:",h.value)});function q(m){const s=v.value.find(i=>i.locationId===m);s&&(s.open=!s.open)}function B(m){console.log(`Toggling destination: ${m}`);const s=h.value.find(i=>i.locationId===m);s&&(s.open=!s.open)}const E=y(()=>{const m=b.reduce((i,n)=>(!n.completed&&n.payloads.forEach(a=>{i[a.destinationID]||(i[a.destinationID]={name:a.destinationID,payloads:[],containerSize:n.containerSize}),i[a.destinationID].payloads.push(a)}),i),{});return Object.values(m).sort((i,n)=>{const a=i.payloads.filter(_=>_.status===d.Collected||_.status===d.Delivered).length;return n.payloads.filter(_=>_.status===d.Collected||_.status===d.Delivered).length-a})}),O=y(()=>b.reduce((s,i)=>(!i.completed&&i.payloads.forEach(n=>{s[n.originID]||(s[n.originID]={name:n.originID,payloads:[],containerSize:i.containerSize}),s[n.originID].payloads.push(n)}),s),{}));return(m,s)=>{const i=V("Button");return l(),r("main",F,[t("div",T,[s[2]||(s[2]=t("h3",{class:"main-destination-heading"},"Origins",-1)),t("div",null,[(l(!0),r(f,null,g(O.value,n=>{var a;return l(),r("div",U,[t("div",{onClick:e=>q(n.name),class:"d-flex",style:{cursor:"pointer"}},[t("h4",null,o(n.name),1),t("span",L,o((a=v.value.find(e=>e.locationId===n.name))!=null&&a.open?"▲":"▼"),1)],8,Y),(l(!0),r(f,null,g(n.payloads,e=>{var _;return w((l(),r("div",{id:"destination-instance-payload",class:z([{disabled:e.status!=u(d).Ready}])},[t("div",M,[t("div",A,[t("div",G,[t("div",H,[t("div",J,"x"+o(e.quantity),1),t("div",K,[t("div",Q,[t("div",W,o(e.commodityID),1)])]),t("div",X,[(l(!0),r(f,null,g(u($)(e.quantity??0,n.containerSize),(c,I)=>(l(),r("div",{key:I,class:"d-flex flex-column align-items-center mx-1",style:{background:"gainsboro",width:"3rem","border-radius":"0.5rem"}},[t("div",Z,"x"+o(c.quantity),1),t("div",tt,o(c.size)+" scu",1)]))),128))])])])]),t("div",st,[e.status==u(d).Ready?(l(),p(i,{key:0,class:"btn btn-primary ml-auto",onClick:c=>e.status=u(d).Collected},{default:x(()=>s[0]||(s[0]=[C("Collect")])),_:2},1032,["onClick"])):D("",!0),e.status===u(d).Collected?(l(),p(i,{key:1,class:"btn btn-undo ml-auto",onClick:c=>e.status=u(d).Ready},{default:x(()=>s[1]||(s[1]=[C("Uncollect")])),_:2},1032,["onClick"])):D("",!0)])]),t("div",et,[t("p",nt,o(e.originID)+" -> "+o(e.destinationID),1),t("div",it,"Status: "+o(e.status),1)])],2)),[[S,(_=v.value.find(c=>c.locationId===n.name))==null?void 0:_.open]])}),256))])}),256))])]),s[6]||(s[6]=t("div",{class:"d-none md:d-block",style:{height:"100%",width:"2%"}},null,-1)),t("div",ot,[s[5]||(s[5]=t("h3",{class:"main-destination-heading"},"Destinations",-1)),t("div",null,[(l(!0),r(f,null,g(E.value,n=>{var a;return l(),r("div",lt,[t("div",{onClick:e=>B(n.name),class:"d-flex",style:{cursor:"pointer"}},[t("h4",null,o(n.name),1),t("span",at,o((a=h.value.find(e=>e.locationId===n.name))!=null&&a.open?"▲":"▼"),1)],8,dt),(l(!0),r(f,null,g(n.payloads,e=>{var _;return w((l(),r("div",{id:"destination-instance-payload",class:z([{disabled:e.status==u(d).Ready}])},[t("div",ct,[t("div",rt,[t("div",ut,[t("div",_t,[t("div",mt,"x"+o(e.quantity),1),t("div",vt,[t("div",ht,[t("div",ft,o(e.commodityID),1)])]),t("div",gt,[(l(!0),r(f,null,g(u($)(e.quantity??0,n.containerSize),(c,I)=>(l(),r("div",{key:I,class:"d-flex flex-column align-items-center mx-1",style:{background:"gainsboro",width:"3rem","border-radius":"0.5rem"}},[t("div",pt,"x"+o(c.quantity),1),t("div",xt,o(c.size)+" scu",1)]))),128))])])])]),t("div",Ct,[e.status===u(d).Collected?(l(),p(i,{key:0,class:"btn btn-primary ml-auto",onClick:c=>e.status=u(d).Delivered},{default:x(()=>s[3]||(s[3]=[C("Deliver")])),_:2},1032,["onClick"])):D("",!0),e.status===u(d).Delivered?(l(),p(i,{key:1,class:"btn btn-undo ml-auto",onClick:c=>e.status=u(d).Collected},{default:x(()=>s[4]||(s[4]=[C("Undeliver")])),_:2},1032,["onClick"])):D("",!0)])]),t("div",Dt,[t("p",bt,o(e.originID)+" -> "+o(e.destinationID),1),t("div",It,"Status: "+o(e.status),1)])],2)),[[S,(_=h.value.find(c=>c.locationId===n.name))==null?void 0:_.open]])}),256))])}),256))])])])}}}),St=j(kt,[["__scopeId","data-v-8d08b3b9"]]);export{St as default};
